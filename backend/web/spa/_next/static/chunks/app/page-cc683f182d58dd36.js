(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7987:(e,t,s)=>{Promise.resolve().then(s.bind(s,9746))},9746:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eS});var a=s(5155),l=s(2115),n=s(6671);let r="/api";class i{set(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4;this.cache.set(e,{data:t,timestamp:Date.now(),ttl:s})}get(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}invalidate(e){this.cache.delete(e)}clear(){this.cache.clear()}constructor(){this.cache=new Map}}let o=new i;async function c(e){if(!e.ok){let t;try{let s=e.headers.get("content-type");if(s&&s.includes("application/json")){let s=await e.json();t=s.message||s.error||"HTTP ".concat(e.status)}else t=await e.text()}catch(s){t="HTTP ".concat(e.status,": ").concat(e.statusText)}throw Error(t)}let t=e.headers.get("content-type");if(t&&t.includes("application/json"))return e.json();throw Error("Expected JSON response but received HTML")}function d(e){if(!e.success)throw Error(e.message||"API request failed");return e.data}function u(e,t,s){let a=e.then(c);return n.o.promise(a,{loading:t,success:s||"Operation completed",error:e=>"Error: ".concat(e.message)}),a}async function m(){return c(await fetch("".concat(r,"/status")))}async function f(e){for(let t of e.getAll("files"))if(t.size>0x1400000)throw Error('File "'.concat(t.name,'" exceeds ').concat(20,"MB limit"));let t=async()=>{let t=await fetch("".concat(r,"/media"),{method:"POST",body:e,signal:AbortSignal.timeout(3e5)});return d(await c(t))},s=await n.o.promise(t(),{loading:"Starting upload...",success:"Upload started - processing in background",error:e=>"Upload failed: ".concat(e.message)});return E(),s}async function x(e){let t=await u(fetch("".concat(r,"/media/").concat(e,"/activate"),{method:"POST"}),"Activating media...","Media activated");return E(),t}async function h(e){let t=await u(fetch("".concat(r,"/media/").concat(e),{method:"DELETE"}),"Deleting media...","Media deleted");return E(),t}async function p(e){let t=await u(fetch("".concat(r,"/loop"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:e})}),"Adding to loop...","Added to loop");return E(),t}async function g(e){let t=await u(fetch("".concat(r,"/loop/").concat(e),{method:"DELETE"}),"Removing from loop...","Removed from loop");return E(),t}async function v(e){let t=await u(fetch("".concat(r,"/loop"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({loop:e})}),"Saving order…","Loop order saved");return E(),t}async function b(){return u(fetch("".concat(r,"/playback/toggle"),{method:"POST"}),"Toggling playback...")}async function y(){return u(fetch("".concat(r,"/playback/loop-mode"),{method:"POST"}),"Toggling loop mode...")}async function j(){return d(await u(fetch("".concat(r,"/wifi/scan")),"Scanning for networks...","Networks found"))}async function N(e,t){return u(fetch("".concat(r,"/wifi/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ssid:e,password:t})}),"Connecting to ".concat(e,"..."),"Connected to ".concat(e))}async function w(){return u(fetch("".concat(r,"/wifi/hotspot"),{method:"POST"}),"Toggling hotspot...")}async function k(){let e=await fetch("".concat(r,"/storage"));return d(await c(e))}async function C(){return d(await u(fetch("".concat(r,"/updates/check")),"Checking for updates..."))}async function S(){return u(fetch("".concat(r,"/updates/install"),{method:"POST"}),"Installing update...","Update installed successfully")}async function A(e){let t="dashboard",s=o.get(t);if(s&&!(null==e?void 0:e.signal))return s;let a=await fetch("".concat(r,"/dashboard"),e),l=await c(a);return o.set(t,l,1e4),l}function E(){o.invalidate("dashboard")}async function I(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e3,l=0,n=setInterval(async()=>{try{var a;let i=new AbortController,o=setTimeout(()=>i.abort(),6e4),c=await fetch("".concat(r,"/media/progress"),{signal:i.signal});if(clearTimeout(o),!c.ok)throw Error("HTTP ".concat(c.status));let d=await c.json(),u=(null===(a=d.data)||void 0===a?void 0:a.jobs)||{};l=0;let m={};for(let[t,s]of Object.entries(u))e.includes(t)&&s&&"object"==typeof s&&(m[t]={job_id:s.job_id||t,filename:s.filename||"",status:s.status||"processing",progress:Number(s.progress)||0,stage:s.stage||"",message:s.message||"",timestamp:Number(s.timestamp)||Date.now()/1e3});t(m),e.every(e=>{let t=u[e];return t&&("completed"===t.status||"error"===t.status)})&&(clearInterval(n),s())}catch(e){l++,console.error("Error polling progress (".concat(l,"/").concat(5,"):"),e),l>=5&&(console.error("Too many consecutive errors, stopping progress polling"),clearInterval(n),s())}},a);return()=>clearInterval(n)}var T=s(5143),F=s(402),O=s(8266);function D(e){let{src:t,alt:s,className:n,placeholder:r="/placeholder.svg"}=e,[i,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),u=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=new IntersectionObserver(t=>{let[s]=t;s.isIntersecting&&(d(!0),e.disconnect())},{rootMargin:"50px",threshold:.1});return u.current&&e.observe(u.current),()=>e.disconnect()},[]),(0,a.jsx)("img",{ref:u,src:c?t:r,alt:s,className:"".concat(n," ").concat(!i&&c?"opacity-50":"opacity-100"," transition-opacity duration-300"),onLoad:()=>o(!0),loading:"lazy"})}function L(e){let{item:t,isActive:s,isInLoop:l,onActivate:n,onDelete:r,onAddToLoop:i,onRemove:o}=e,{attributes:c,listeners:d,setNodeRef:u,transform:m,transition:f,isDragging:x}=(0,F.gl)({id:t.slug}),h={transform:O.Ks.Transform.toString(m),transition:f,opacity:x?.5:1};return(0,a.jsxs)("div",{ref:u,style:h,className:"group flex items-center gap-8 p-8 transition-all ".concat(s?"bg-accent":"hover:bg-accent/30"),children:[(0,a.jsx)("div",{...c,...d,className:"cursor-grab active:cursor-grabbing opacity-30 hover:opacity-100 transition-opacity",children:(0,a.jsxs)("div",{className:"w-5 h-5 flex flex-col gap-1",children:[(0,a.jsx)("div",{className:"w-full h-0.5 bg-current rounded"}),(0,a.jsx)("div",{className:"w-full h-0.5 bg-current rounded"}),(0,a.jsx)("div",{className:"w-full h-0.5 bg-current rounded"})]})}),(0,a.jsx)("div",{className:"w-32 aspect-[32/24] rounded-2xl overflow-hidden bg-muted flex-shrink-0 ".concat(l?"":"opacity-40 grayscale"),children:t.url&&t.type.startsWith("image/")?(0,a.jsx)(D,{src:t.url,alt:t.filename,className:"w-full h-full object-cover"}):t.url&&t.type.startsWith("video/")?(0,a.jsx)("video",{src:t.url,muted:!0,loop:!0,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"□"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 mb-2",children:(0,a.jsx)("h4",{className:"font-semibold text-lg truncate",children:t.filename})}),(0,a.jsxs)("div",{className:"flex items-center gap-8 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:[(t.size/1024/1024).toFixed(1)," MB"]}),(0,a.jsx)("span",{children:new Date(t.uploadedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),t.duration&&(0,a.jsxs)("span",{children:[t.duration,"s"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:()=>l?o(t.slug):i(t),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat(l?"bg-green-400 text-black hover:bg-green-500":"bg-muted text-muted-foreground hover:bg-accent"),title:l?"Disable":"Enable",children:l?"Active":"Inactive"}),(0,a.jsx)("button",{onClick:()=>r(t.slug),className:"h-12 w-12 rounded-xl hover:bg-destructive hover:text-white flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-lg",children:"\xd7"})})]})]})}function P(e){var t,s;let{activeSlug:r,status:i,onCurrentlyPlayingChange:o}=e,[c,d]=(0,l.useState)([]),[u,m]=(0,l.useState)([]),[f,b]=(0,l.useState)(0),y=(0,T.FR)((0,T.MS)(T.AN),(0,T.MS)(T.uN,{coordinateGetter:F.JR}));(0,l.useEffect)(()=>{let e=async()=>{try{var e,t;let s=await A(),a=null!==(e=s.media)&&void 0!==e?e:[],l=(null!==(t=s.loop)&&void 0!==t?t:[]).map(e=>a.find(t=>t.slug===e)).filter(Boolean);if(d(a),m(l),s.active){let e=l.findIndex(e=>e.slug===s.active);-1!==e&&b(e)}}catch(e){console.error("Failed to fetch data:",e)}};e();let t=setInterval(e,parseInt("4000",10));return()=>clearInterval(t)},[]),(0,l.useEffect)(()=>{let e=()=>{E(),A().then(e=>{var t,s;let a=null!==(t=e.media)&&void 0!==t?t:[];d(a);let l=(null!==(s=e.loop)&&void 0!==s?s:[]).map(e=>a.find(t=>t.slug===e)).filter(Boolean);if(m(l),e.active){let t=l.findIndex(t=>t.slug===e.active);-1!==t&&b(t)}}).catch(console.error)};return window.addEventListener("mediaUploaded",e),()=>{window.removeEventListener("mediaUploaded",e)}},[]),(0,l.useEffect)(()=>{var e;if((null==i?void 0:null===(e=i.player)||void 0===e?void 0:e.is_playing)&&u.length>0){let e=setInterval(()=>{b(e=>(e+1)%u.length)},8e3);return()=>clearInterval(e)}},[null==i?void 0:null===(t=i.player)||void 0===t?void 0:t.is_playing,u.length]),(0,l.useEffect)(()=>{o(u.length>0?u[f]:null)},[u,f,o]);let j=async e=>{try{await x(e);let t=u.findIndex(t=>t.slug===e);-1!==t&&b(t)}catch(e){n.o.error("Failed to play media")}},N=async e=>{try{var t,s;await g(e);let a=await A(),l=null!==(t=a.media)&&void 0!==t?t:[],n=(null!==(s=a.loop)&&void 0!==s?s:[]).map(e=>l.find(t=>t.slug===e)).filter(Boolean);if(d(l),m(n),a.active){let e=n.findIndex(e=>e.slug===a.active);-1!==e&&b(e)}else b(0)}catch(e){n.o.error("Failed to remove from loop")}},w=async e=>{try{var t,s;await h(e);let a=await A(),l=null!==(t=a.media)&&void 0!==t?t:[],n=(null!==(s=a.loop)&&void 0!==s?s:[]).map(e=>l.find(t=>t.slug===e)).filter(Boolean);if(d(l),m(n),a.active&&n.length>0){let e=n.findIndex(e=>e.slug===a.active);-1!==e?b(e):b(0)}else b(0)}catch(e){n.o.error("Failed to delete media")}},k=async e=>{try{var t,s;await p(e.slug);let a=await A(),l=null!==(t=a.media)&&void 0!==t?t:[],n=(null!==(s=a.loop)&&void 0!==s?s:[]).map(e=>l.find(t=>t.slug===e)).filter(Boolean);if(d(l),m(n),a.active){let e=n.findIndex(e=>e.slug===a.active);-1!==e&&b(e)}}catch(e){n.o.error("Failed to add to loop")}},C=u.map(e=>e.slug),S=u.length>0?null===(s=u[f])||void 0===s?void 0:s.slug:r;return(0,a.jsx)("div",{className:"space-y-16 pb-24",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Loop Library"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[c.length," items"]})]}),0===c.length?(0,a.jsxs)("div",{className:"rounded-3xl bg-muted/20 py-32 text-center",children:[(0,a.jsx)("div",{className:"text-8xl mb-8",children:"□"}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"No media"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Upload files to get started"})]}):(0,a.jsx)("div",{className:"rounded-3xl bg-card overflow-hidden",children:(0,a.jsx)(T.Mp,{sensors:y,collisionDetection:T.fp,onDragEnd:e=>{let{active:t,over:s}=e;s&&t.id!==s.id&&d(e=>{let a=e.findIndex(e=>e.slug===t.id),l=e.findIndex(e=>e.slug===s.id),n=(0,F.be)(e,a,l),r=new Set(u.map(e=>e.slug));return v(n.filter(e=>r.has(e.slug)).map(e=>e.slug)).catch(console.error),n})},children:(0,a.jsx)(F.gB,{items:c.map(e=>e.slug),strategy:F._G,children:(0,a.jsx)("div",{className:"divide-y divide-border",children:c.map(e=>(0,a.jsx)(L,{item:e,isActive:e.slug===S,isInLoop:C.includes(e.slug),onActivate:j,onDelete:w,onAddToLoop:k,onRemove:N},e.slug))})})})})]})})}function R(){return(0,a.jsx)("div",{className:"space-y-16 pb-24",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Loop Library"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]}),(0,a.jsx)("div",{className:"rounded-3xl bg-muted/20 py-32 text-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-muted rounded-full animate-spin border-t-primary"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Connecting to LOOP..."})]})})]})})}var U=s(9708),M=s(2085),_=s(2596),z=s(9688);function B(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,z.QP)((0,_.$)(t))}let H=(0,M.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),J=l.forwardRef((e,t)=>{let{className:s,variant:l,size:n,asChild:r=!1,...i}=e,o=r?U.DX:"button";return(0,a.jsx)(o,{className:B(H({variant:l,size:n,className:s})),ref:t,...i})});J.displayName="Button";var V=s(5863);let G=l.forwardRef((e,t)=>{let{className:s,value:l,...n}=e;return(0,a.jsx)(V.bL,{ref:t,className:B("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,a.jsx)(V.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});G.displayName=V.bL.displayName;var W=s(9028);let X=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(W.bL,{className:B("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...l,ref:t,children:(0,a.jsx)(W.zi,{className:B("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});function Y(e){var t,s,r;let{status:i,currentlyPlaying:o,maxSizeMB:c}=e,[d,u]=(0,l.useState)(!1),[m,x]=(0,l.useState)(0),[h,p]=(0,l.useState)({}),g=e=>{let t=1048576*c;if(e.filter(e=>e.size>t).length>0)return n.o.error("Files too large. Maximum ".concat(c,"MB")),!1;let s=["image/","video/"];return!(e.filter(e=>!s.some(t=>e.type.startsWith(t))).length>0)||(n.o.error("Unsupported file type"),!1)},v=(0,l.useCallback)(async e=>{if(0!==e.length&&g(e)){u(!0),x(0),p({});try{let t=new FormData;Array.from(e).forEach(e=>{t.append("files",e)});let s=setInterval(()=>{x(e=>Math.min(e+20,90))},100),{job_ids:a}=await f(t);clearInterval(s),x(100),I(a,e=>{p(e)},()=>{window.dispatchEvent(new CustomEvent("mediaUploaded")),u(!1),x(0),p({}),n.o.success("Upload completed!")})}catch(e){n.o.error("Upload failed"),u(!1),x(0),p({})}}},[g]),j=(0,l.useCallback)(e=>{let t=e.target.files;t&&v(Array.from(t)),e.target.value=""},[v]),N=()=>{var e;if(d){u(!1),x(0),p({}),n.o.info("Upload cancelled");return}null===(e=document.getElementById("toolbar-file-input"))||void 0===e||e.click()};(0,l.useEffect)(()=>{let e=e=>{let{files:t}=e.detail;v(t)};return window.addEventListener("globalFileDrop",e),()=>{window.removeEventListener("globalFileDrop",e)}},[v]);let w=async()=>{try{await b()}catch(e){n.o.error("Failed to toggle playback")}},k=async()=>{try{await y()}catch(e){n.o.error("Failed to toggle loop mode")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/*,video/*,.gif",onChange:j,className:"hidden",id:"toolbar-file-input",disabled:d}),(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-black border-t border-gray-800",children:(0,a.jsx)("div",{className:"mx-auto max-w-6xl px-8 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-gray-800 flex-shrink-0",children:(null==o?void 0:o.url)&&o.type.startsWith("image/")?(0,a.jsx)("img",{src:o.url||"/placeholder.svg",alt:o.filename,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"□"})})}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("div",{className:"text-white text-sm font-medium truncate",children:o?o.filename:"No media in loop"}),(0,a.jsx)("div",{className:"text-gray-400 text-xs",children:o?"Now Playing":"Add media to start"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:(null==i?void 0:null===(t=i.player)||void 0===t?void 0:t.loop_mode)==="all"?"Loop All":"Loop One"}),(0,a.jsx)(X,{checked:(null==i?void 0:null===(s=i.player)||void 0===s?void 0:s.loop_mode)==="all",onCheckedChange:k,className:"data-[state=checked]:bg-green-400 data-[state=unchecked]:bg-gray-600"})]}),(0,a.jsx)("button",{onClick:w,className:"h-10 w-10 rounded-full bg-white text-black hover:bg-gray-100 transition-colors flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-lg",children:(null==i?void 0:null===(r=i.player)||void 0===r?void 0:r.is_playing)?"⏸":"▶"})})]}),(0,a.jsx)("div",{className:"flex items-center justify-end flex-1",children:d?(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-32",children:(0,a.jsx)(G,{value:m,className:"h-1"})}),(0,a.jsx)("div",{className:"text-xs text-gray-400 min-w-0",children:Object.keys(h).length>0?"Processing ".concat(Object.keys(h).length," files..."):m<100?"Uploading...":"Starting processing..."}),(0,a.jsx)("button",{onClick:N,className:"text-gray-400 hover:text-white text-sm transition-colors",children:"Cancel"})]}):(0,a.jsx)(J,{onClick:N,className:"bg-white text-black hover:bg-gray-100 rounded-full px-6 py-2 text-sm font-medium transition-colors",children:"+ Add Media"})})]})})})]})}X.displayName=W.bL.displayName;var q=s(1189),K=s(4416);let Q=q.bL,Z=q.l9,$=q.ZL;q.bm;let ee=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(q.hJ,{ref:t,className:B("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l})});ee.displayName=q.hJ.displayName;let et=l.forwardRef((e,t)=>{let{className:s,children:l,...n}=e;return(0,a.jsxs)($,{children:[(0,a.jsx)(ee,{}),(0,a.jsxs)(q.UC,{ref:t,className:B("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n,children:[l,(0,a.jsxs)(q.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(K.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});et.displayName=q.UC.displayName;let es=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:B("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};es.displayName="DialogHeader";let ea=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(q.hE,{ref:t,className:B("text-lg font-semibold leading-none tracking-tight",s),...l})});ea.displayName=q.hE.displayName,l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(q.VY,{ref:t,className:B("text-sm text-muted-foreground",s),...l})}).displayName=q.VY.displayName;let el=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("rounded-lg border bg-card text-card-foreground shadow-sm",s),...l})});el.displayName="Card";let en=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("flex flex-col space-y-1.5 p-6",s),...l})});en.displayName="CardHeader";let er=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("text-2xl font-semibold leading-none tracking-tight",s),...l})});er.displayName="CardTitle",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("text-sm text-muted-foreground",s),...l})}).displayName="CardDescription";let ei=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("p-6 pt-0",s),...l})});ei.displayName="CardContent",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:B("flex items-center p-6 pt-0",s),...l})}).displayName="CardFooter";let eo=(0,M.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ec(e){let{className:t,variant:s,...l}=e;return(0,a.jsx)("div",{className:B(eo({variant:s}),t),...l})}let ed=l.forwardRef((e,t)=>{let{className:s,type:l,...n}=e;return(0,a.jsx)("input",{type:l,className:B("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});ed.displayName="Input";var eu=s(968);let em=(0,M.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ef=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(eu.b,{ref:t,className:B(em(),s),...l})});ef.displayName=eu.b.displayName;var ex=s(2652),eh=s(6517),ep=s(4449),eg=s(2919);function ev(){let[e,t]=(0,l.useState)([]),[s,r]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[u,f]=(0,l.useState)(""),[x,h]=(0,l.useState)({connected:!1,ssid:"",hotspotActive:!1});(0,l.useEffect)(()=>{let e=async()=>{try{let e=await m();(null==e?void 0:e.wifi)&&h({connected:!!e.wifi.connected,ssid:e.wifi.current_ssid||"",hotspotActive:!!e.wifi.hotspot_active})}catch(e){}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[]);let p=async()=>{r(!0);try{let e=await j();t(e.networks),n.o.success("Found ".concat(e.networks.length," networks"))}catch(e){n.o.error("Failed to scan for networks")}finally{r(!1)}},g=async()=>{if(c){o(!0);try{await N(c.ssid,u),n.o.success("Connected to ".concat(c.ssid)),h(e=>({...e,connected:!0,ssid:c.ssid})),d(null),f("")}catch(e){n.o.error("Failed to connect to network")}finally{o(!1)}}},v=async()=>{try{await w();let e=!x.hotspotActive;h(t=>({...t,hotspotActive:e})),n.o.success(e?"Hotspot enabled":"Hotspot disabled")}catch(e){n.o.error("Failed to toggle hotspot")}},b=e=>e>75?(0,a.jsx)(ex.A,{className:"h-4 w-4"}):e>50?(0,a.jsx)(ex.A,{className:"h-4 w-4 opacity-75"}):e>25?(0,a.jsx)(ex.A,{className:"h-4 w-4 opacity-50"}):(0,a.jsx)(ex.A,{className:"h-4 w-4 opacity-25"});return(0,a.jsxs)(el,{children:[(0,a.jsx)(en,{children:(0,a.jsx)(er,{children:"WiFi Configuration"})}),(0,a.jsxs)(ei,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[x.connected?(0,a.jsx)(eh.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(ep.A,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("span",{className:"font-medium",children:x.connected?'Connected to "'.concat(x.ssid,'"'):"Not connected"})]}),x.hotspotActive&&(0,a.jsx)(ec,{variant:"secondary",children:"Hotspot Active"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(J,{onClick:p,disabled:s,variant:"outline",children:s?"Scanning...":"Scan for Networks"}),(0,a.jsx)(J,{onClick:v,variant:x.hotspotActive?"destructive":"outline",children:x.hotspotActive?"Disable Hotspot":"Enable Hotspot"})]}),e.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Available Networks"}),(0,a.jsx)("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:e.map(e=>(0,a.jsxs)(Q,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg cursor-pointer hover:bg-accent",onClick:()=>d(e),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"font-medium",children:e.ssid}),e.secured&&(0,a.jsx)(eg.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[b(e.signal),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[e.signal,"%"]})]})]})}),(0,a.jsxs)(et,{children:[(0,a.jsx)(es,{children:(0,a.jsxs)(ea,{children:["Connect to ",e.ssid]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[e.secured&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ef,{htmlFor:"password",children:"Password"}),(0,a.jsx)(ed,{id:"password",type:"password",value:u,onChange:e=>f(e.target.value),placeholder:"Enter network password"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(J,{variant:"outline",onClick:()=>d(null),children:"Cancel"}),(0,a.jsx)(J,{onClick:g,disabled:i||e.secured&&!u,children:i?"Connecting...":"Connect"})]})]})]})]},e.ssid))})]})]})]})}var eb=s(646),ey=s(1788);function ej(){let[e]=(0,l.useState)("1.0.0"),[t,s]=(0,l.useState)(null),[r,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),d=async()=>{i(!0);try{(await C()).updates_available.git?(s("Available"),n.o.success("Git update available")):n.o.success("System is up to date")}catch(e){n.o.error("Failed to check for updates")}finally{i(!1)}},u=async()=>{if(t){c(!0);try{await S(),n.o.success("Update installed - device will restart"),s(null)}catch(e){n.o.error("Failed to install update")}finally{c(!1)}}};return(0,a.jsxs)(el,{children:[(0,a.jsx)(en,{children:(0,a.jsx)(er,{children:"System & Updates"})}),(0,a.jsxs)(ei,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eb.A,{className:"h-5 w-5 text-green-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Current Version"})]}),(0,a.jsx)(ec,{variant:"outline",children:e})]}),t&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-primary/5 border border-primary/20 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ey.A,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("span",{className:"font-medium",children:"Update Available"})]}),(0,a.jsx)(ec,{children:t})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(J,{onClick:d,disabled:r,variant:"outline",children:r?"Checking...":"Check for Updates"}),(0,a.jsx)(J,{onClick:u,disabled:!t||o,children:o?"Installing...":"Install Update"})]}),t&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground p-3 bg-muted rounded-lg",children:[(0,a.jsx)("strong",{children:"Note:"})," The device will automatically restart after the update is installed. Make sure no critical operations are running."]})]})]})}function eN(){let e;let[t,s]=(0,l.useState)(null);if((0,l.useEffect)(()=>{let e=async()=>{try{let e=await k();s(e)}catch(e){console.error("Failed to fetch storage info:",e)}};e();let t=setInterval(e,parseInt("4000",10));return()=>clearInterval(t)},[]),!t)return null;let n=e=>0===e?"0 GB":"".concat((e/0x40000000).toFixed(1)," GB"),r=t.system/t.total*100,i=t.app/t.total*100,o=t.media/t.total*100;return t.free,t.total,(0,a.jsxs)("div",{className:"rounded-3xl bg-card p-8",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-8",children:"Storage"}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[n(t.used)," of ",n(t.total)," used"]}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:[n(t.free)," available"]})]}),(0,a.jsxs)("div",{className:"h-2 bg-muted rounded-full overflow-hidden flex",children:[(0,a.jsx)("div",{className:"bg-blue-500 h-full",style:{width:"".concat(r,"%")}}),(0,a.jsx)("div",{className:"bg-purple-500 h-full",style:{width:"".concat(i,"%")}}),(0,a.jsx)("div",{className:"bg-green-500 h-full",style:{width:"".concat(o,"%")}})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"System"})]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n(t.system)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"LOOP App"})]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n(t.app)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm",children:"Media Files"})]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n(t.media)})]})]})]})}function ew(e){let{isOpen:t,onClose:s}=e;return(0,a.jsx)(Q,{open:t,onOpenChange:s,children:(0,a.jsx)(et,{className:"max-w-4xl max-h-[90vh] overflow-y-auto p-0",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsx)("h2",{className:"text-3xl font-semibold",children:"Settings"}),(0,a.jsx)("button",{onClick:s,className:"h-10 w-10 rounded-xl hover:bg-accent flex items-center justify-center text-muted-foreground hover:text-foreground",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(eN,{}),(0,a.jsx)(ev,{}),(0,a.jsx)(ej,{})]})]})})})}function ek(e){let{isVisible:t,maxSizeMB:s}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-background/60 backdrop-blur-md",children:(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"rounded-3xl bg-card p-20 text-center shadow-2xl",children:[(0,a.jsx)("div",{className:"text-6xl mb-8",children:"↓"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Drop to upload"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Maximum ",s,"MB per file"]})]})})}):null}let eC=parseInt("4000",10);function eS(){let[e,t]=(0,l.useState)(null),[s,n]=(0,l.useState)(null),[r,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!0),[d,u]=(0,l.useState)(!1),[m,f]=(0,l.useState)(0),[x,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=null,s=async()=>{e&&e.abort(),e=new AbortController;try{let s=await A({signal:e.signal});t(s.status),n(s.active),i(!0)}catch(e){(null==e?void 0:e.name)!=="AbortError"&&i(!1)}finally{c(!1)}};s();let a=setInterval(s,eC);return()=>{clearInterval(a),e&&e.abort()}},[]);let v=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),f(e=>e+1),e.dataTransfer.items&&e.dataTransfer.items.length>0&&u(!0)},[]),b=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),f(e=>{let t=e-1;return 0===t&&u(!1),t})},[]),y=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),j=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),u(!1),f(0);let t=Array.from(e.dataTransfer.files);if(t.length>0){let e=new CustomEvent("globalFileDrop",{detail:{files:t}});window.dispatchEvent(e)}},[]);return(0,a.jsxs)("div",{className:"min-h-screen bg-background",onDragEnter:v,onDragLeave:b,onDragOver:y,onDrop:j,children:[(0,a.jsx)(ek,{isVisible:d,maxSizeMB:20}),(0,a.jsx)("header",{className:"border-b border-border",children:(0,a.jsx)("div",{className:"mx-auto max-w-6xl px-8 py-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h1",{className:"text-3xl font-semibold",children:["LOOP ",(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"v0.1"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(r?"bg-green-400":"bg-red-400")}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:r?"Connected":"Offline"})]}),(0,a.jsx)("button",{onClick:()=>h(!0),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Settings"})]})]})})}),(0,a.jsx)("main",{className:"mx-auto max-w-6xl px-8 py-12",children:o?(0,a.jsx)(R,{}):(0,a.jsx)(P,{activeSlug:null!=s?s:void 0,status:e,onCurrentlyPlayingChange:g})}),(0,a.jsx)(Y,{status:e,currentlyPlaying:p,maxSizeMB:20}),(0,a.jsx)(ew,{isOpen:x,onClose:()=>h(!1)})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[671,984,441,684,358],()=>t(7987)),_N_E=e.O()}]);