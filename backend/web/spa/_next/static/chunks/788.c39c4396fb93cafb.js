(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418,788],{666:e=>{!function(){var t={229:function(e){var t,o,n,r=e.exports={};function a(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(o){try{return t.call(null,e,0)}catch(o){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{o="function"==typeof clearTimeout?clearTimeout:l}catch(e){o=l}}();var c=[],s=!1,f=-1;function g(){s&&n&&(s=!1,n.length?c=n.concat(c):f=-1,c.length&&u())}function u(){if(!s){var e=i(g);s=!0;for(var t=c.length;t;){for(n=c,c=[];++f<t;)n&&n[f].run();f=-1,t=c.length}n=null,s=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===l||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];c.push(new d(e,t)),1!==c.length||s||i(u)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var a=o[e]={exports:{}},l=!0;try{t[e](a,a.exports,n),l=!1}finally{l&&delete o[e]}return a.exports}n.ab="//",e.exports=n(229)}()},1418:(e,t,o)=>{"use strict";o.d(t,{convertToRgb565Zip:()=>i});var n=o(4953),r=o(9311),a=o.n(r);async function l(e,t,o){var n,r,a,l,i,c;null===(n=o.onProgress)||void 0===n||n.call(o,0,"resizing"),null===(r=o.onLog)||void 0===r||r.call(o,"Starting video optimization...");let s=e=>{var t;let{progress:n}=e;null===(t=o.onProgress)||void 0===t||t.call(o,15*n,"resizing")},f=e=>{let{message:t}=e};e.on("progress",s),e.on("log",f);let g="scale=".concat(320,":").concat(240,":force_original_aspect_ratio=increase,crop=").concat(320,":").concat(240,",fps=").concat(25);await e.exec(["-i",t,"-vf",g,"-c:v","mpeg4","-q:v","8","-an","-y","optimized.mp4"]),e.off("progress",s),e.off("log",f),null===(a=o.onProgress)||void 0===a||a.call(o,15,"resizing"),null===(l=o.onLog)||void 0===l||l.call(o,"Video optimization complete");try{await e.deleteFile(t),null===(i=o.onLog)||void 0===i||i.call(o,"Deleted original ".concat(t," from MEMFS after optimization"))}catch(e){null===(c=o.onLog)||void 0===c||c.call(o,"Warning: Could not delete ".concat(t,": ").concat(e))}}async function i(e){var t,o,r,i,c,s,f,g,u,d,p,m,h,v,y,w;let b,F,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0,x="input_media";if(_)b=_;else{let t=await e.arrayBuffer(),o=Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").slice(0,16),n=e.name.replace(/\.[^.]+$/,"").replace(/\s+/g,"_").toLowerCase();b="".concat(n,"_").concat(o)}let L=e.type.startsWith("image/")||e.name.toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/),D=new Uint8Array(await e.arrayBuffer()),T=null;if(L){let l=await (0,n.H)();await l.writeFile(x,D),null===(t=E.onProgress)||void 0===t||t.call(E,0,"converting");let i="output.raw";await l.exec(["-i",x,"-vf","scale=".concat(320,":").concat(240,":force_original_aspect_ratio=increase,crop=").concat(320,":").concat(240),"-f","rawvideo","-pix_fmt","rgb565be","-vframes","1",i]),T=await l.readFile(i),F=1,await l.deleteFile(i),null===(o=E.onProgress)||void 0===o||o.call(E,90,"converting");let c=new(a());c.file("frame_000001.rgb",T);let s={slug:b,original_filename:e.name,type:"image",width:320,height:240,frame_count:1,format:"rgb565",fps:0};if(c.file("metadata.json",JSON.stringify(s)),"function"==typeof l.exit)try{await l.exit()}catch(e){}return null===(r=E.onProgress)||void 0===r||r.call(E,100,"converting"),{slug:b,blob:await c.generateAsync({type:"blob"})}}{let t=await (0,n.H)();await t.writeFile(x,D),D=null,await l(t,x,E),null===(i=E.onProgress)||void 0===i||i.call(E,15,"converting"),null===(c=E.onLog)||void 0===c||c.call(E,"Starting frame extraction..."),t.on("log",e=>{var t;let{message:o}=e;null===(t=E.onLog)||void 0===t||t.call(E,o)});let o=new(a()),r="frame_%06d.rgb",_="optimized.mp4",L=0,T=0;for(;;){let e=0===L?["-i",_,"-frames:v","".concat(75),"-an","-threads","1","-c:v","rawvideo","-pix_fmt","rgb565be","-f","image2","-fps_mode","passthrough",r]:["-ss","".concat(L),"-i",_,"-frames:v","".concat(75),"-an","-threads","1","-c:v","rawvideo","-pix_fmt","rgb565be","-f","image2","-fps_mode","passthrough",r];try{await t.exec(e)}catch(e){if(!String(e||"").includes("Aborted"))throw e}let n=[];try{console.log("[DEBUG] Attempting to list files after FFmpeg exec...");let e=await t.listDir("/");console.log("[DEBUG] Raw fileList:",e),console.log("[DEBUG] Files found:",e.map(e=>{let t="string"==typeof e?e:e.name,o=/^frame_\d{6}\.rgb$/.test(t);return console.log('[DEBUG] File: "'.concat(t,'" matches regex: ').concat(o)),{name:t,matches:o}})),n=e.filter(e=>{let t="string"==typeof e?e:e.name;return/^frame_\d{6}\.rgb$/.test(t)}),console.log("[DEBUG] Filtered frameFiles:",n),null===(d=E.onLog)||void 0===d||d.call(E,"Found ".concat(e.length," total files: ").concat(e.map(e=>"string"==typeof e?e:e.name).join(", "))),null===(p=E.onLog)||void 0===p||p.call(E,"Found ".concat(n.length," frame files: ").concat(n.map(e=>"string"==typeof e?e:e.name).join(", ")))}catch(e){console.log("[DEBUG] listDir failed, trying alternative approach:",e),n=[]}if(0===n.length){console.log("[DEBUG] No frames found via listDir, trying aggressive fallback...");for(let e=1;e<=75;e++){let o="frame_".concat(e.toString().padStart(6,"0"),".rgb");try{let e=await t.readFile(o);e&&e.length>0&&(n.push(o),console.log("[DEBUG] Fallback found frame: ".concat(o," (").concat(e.length," bytes)")))}catch(e){break}}if(0===n.length)try{for(let e of(await t.listDir("/"))){let o="string"==typeof e?e:e.name;if(o.endsWith(".rgb"))try{let e=await t.readFile(o);e&&e.length>0&&(n.push(o),console.log("[DEBUG] Emergency fallback found: ".concat(o," (").concat(e.length," bytes)")))}catch(e){console.log("[DEBUG] Failed to read ".concat(o,":"),e)}}}catch(e){console.log("[DEBUG] Emergency fallback failed:",e)}console.log("[DEBUG] Total fallback frames found: ".concat(n.length)),null===(m=E.onLog)||void 0===m||m.call(E,"Fallback method found ".concat(n.length," frame files"))}if(0===n.length){if(0===T){try{let e=await t.listDir("/");console.error("[DEBUG] All files in MEMFS:",e),null===(v=E.onLog)||void 0===v||v.call(E,"CRITICAL: No frames found despite ".concat(e.length," files in MEMFS. Files: ").concat(e.map(e=>"string"==typeof e?e:e.name).join(", ")))}catch(e){console.error("[DEBUG] Failed to list all files:",e)}throw null===(h=E.onLog)||void 0===h||h.call(E,"First chunk failed - no frames found. Check debug logs above."),Error("FFmpeg could not extract frames - check console for detailed debugging info")}break}for(let e of(n.sort((e,t)=>{let o="string"==typeof e?e:e.name,n="string"==typeof t?t:t.name;return parseInt(o.match(/\d+/)[0])-parseInt(n.match(/\d+/)[0])}),n)){let n="string"==typeof e?e:e.name;console.log("[DEBUG] Processing frame file: ".concat(n));let r=await t.readFile(n);T++,o.file("frame_".concat(T.toString().padStart(6,"0"),".rgb"),r);try{await t.deleteFile(n)}catch(e){console.log("[DEBUG] Could not delete ".concat(n,":"),e)}}let a=15+(L+=3)/600*80;null===(u=E.onProgress)||void 0===u||u.call(E,Math.min(a,95),"converting")}if(0===(F=T))throw Error("No frames were successfully extracted from video. Video may be corrupted or in an unsupported format.");null===(s=E.onProgress)||void 0===s||s.call(E,95,"converting"),null===(f=E.onLog)||void 0===f||f.call(E,"Packaging frames...");let k={slug:b,original_filename:e.name,type:"video",width:320,height:240,frame_count:F,format:"rgb565",fps:25};o.file("metadata.json",JSON.stringify(k));let B=await o.generateAsync({type:"blob"});if(null===(g=E.onProgress)||void 0===g||g.call(E,100,"converting"),"function"==typeof t.exit)try{await t.exit(),null===(y=E.onLog)||void 0===y||y.call(E,"FFmpeg WASM heap released")}catch(e){null===(w=E.onLog)||void 0===w||w.call(E,"Warning: FFmpeg cleanup failed: ".concat(e))}return{slug:b,blob:B}}}},4953:(e,t,o)=>{"use strict";o.d(t,{H:()=>a});let n=null;async function r(){if(n)return n;let{FFmpeg:e}=await o.e(654).then(o.bind(o,5654));return n=e}async function a(){let e=new(await r());return await e.load({corePath:"/ffmpeg/umd/ffmpeg-core.js",log:!0}),e}},9509:(e,t,o)=>{"use strict";var n,r;e.exports=(null==(n=o.g.process)?void 0:n.env)&&"object"==typeof(null==(r=o.g.process)?void 0:r.env)?o.g.process:o(666)}}]);