(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[37,137],{666:e=>{!function(){var t={229:function(e){var t,n,o,a=e.exports={};function r(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c=[],s=!1,f=-1;function g(){s&&o&&(s=!1,o.length?c=o.concat(c):f=-1,c.length&&u())}function u(){if(!s){var e=l(g);s=!0;for(var t=c.length;t;){for(o=c,c=[];++f<t;)o&&o[f].run();f=-1,t=c.length}o=null,s=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new d(e,t)),1!==c.length||s||l(u)},d.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},n={};function o(e){var a=n[e];if(void 0!==a)return a.exports;var r=n[e]={exports:{}},i=!0;try{t[e](r,r.exports,o),i=!1}finally{i&&delete n[e]}return r.exports}o.ab="//",e.exports=o(229)}()},8137:(e,t,n)=>{"use strict";n.d(t,{convertToRgb565Zip:()=>s});let o=null;async function a(){if(o)return o;let{FFmpeg:e}=await n.e(654).then(n.bind(n,5654));return o=e}async function r(){let e=new(await a());return await e.load({corePath:"/ffmpeg/umd/ffmpeg-core.js",log:!0}),e}var i=n(9311),l=n.n(i);async function c(e,t,n){var o,a,r,i,l,c;null===(o=n.onProgress)||void 0===o||o.call(n,0,"resizing"),null===(a=n.onLog)||void 0===a||a.call(n,"Starting video optimization...");let s=e=>{var t;let{progress:o}=e;null===(t=n.onProgress)||void 0===t||t.call(n,15*o,"resizing")},f=e=>{let{message:t}=e};e.on("progress",s),e.on("log",f);let g="scale=".concat(320,":").concat(240,":force_original_aspect_ratio=increase,crop=").concat(320,":").concat(240,",fps=").concat(25);await e.exec(["-i",t,"-vf",g,"-c:v","mpeg4","-q:v","8","-an","-y","optimized.mp4"]),e.off("progress",s),e.off("log",f),null===(r=n.onProgress)||void 0===r||r.call(n,15,"resizing"),null===(i=n.onLog)||void 0===i||i.call(n,"Video optimization complete");try{await e.deleteFile(t),null===(l=n.onLog)||void 0===l||l.call(n,"Deleted original ".concat(t," from MEMFS after optimization"))}catch(e){null===(c=n.onLog)||void 0===c||c.call(n,"Warning: Could not delete ".concat(t,": ").concat(e))}}async function s(e){var t,n,o,a,i,s,f,g,u,d,m,p,h,v,w,y,b,F,_;let E,x,L=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},D=arguments.length>2?arguments[2]:void 0,U="input_media";if(D)E=D;else{let t=await e.arrayBuffer(),n=Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").slice(0,16),o=e.name.replace(/\.[^.]+$/,"").replace(/\s+/g,"_").toLowerCase();E="".concat(o,"_").concat(n)}let T=e.type.startsWith("image/")||e.name.toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp|webp)$/),k=new Uint8Array(await e.arrayBuffer());if(T){let a=await r();await a.writeFile(U,k),null===(t=L.onProgress)||void 0===t||t.call(L,0,"converting");let i="output.raw";await a.exec(["-i",U,"-vf","scale=".concat(320,":").concat(240,":force_original_aspect_ratio=increase,crop=").concat(320,":").concat(240),"-f","rawvideo","-pix_fmt","rgb565be","-vframes","1",i]);let c=await a.readFile(i);x=1,await a.deleteFile(i),null===(n=L.onProgress)||void 0===n||n.call(L,90,"converting");let s=new(l()),f=new Uint8Array(8+c.length),g=new DataView(f.buffer);g.setUint32(0,x,!1),g.setUint32(4,153600,!1),f.set(c,8),s.file("frames.bin",f);let u={slug:E,original_filename:e.name,type:"image",width:320,height:240,frame_count:x,format:"rgb565",fps:0};if(s.file("metadata.json",JSON.stringify(u)),"function"==typeof a.exit)try{await a.exit()}catch(e){}return null===(o=L.onProgress)||void 0===o||o.call(L,100,"converting"),{slug:E,blob:await s.generateAsync({type:"blob"})}}{let t=await r();await t.writeFile(U,k),k=null,await c(t,U,L),null===(a=L.onProgress)||void 0===a||a.call(L,15,"converting"),null===(i=L.onLog)||void 0===i||i.call(L,"Starting frame extraction..."),t.on("log",e=>{var t;let{message:n}=e;null===(t=L.onLog)||void 0===t||t.call(L,n)});let n=new(l()),o="frame_%06d.rgb",D="optimized.mp4";try{await t.exec(["-i",D,"-f","null","-"])}catch(e){null===(u=L.onLog)||void 0===u||u.call(L,"Optimized video info check completed (expected failure)")}try{await t.exec(["-i",D,"-vframes","1","-f","rawvideo","-pix_fmt","rgb565be","test_frame.rgb"]);let e=await t.readFile("test_frame.rgb");null===(d=L.onLog)||void 0===d||d.call(L,"✅ Single frame test successful: ".concat(e.length," bytes")),await t.deleteFile("test_frame.rgb")}catch(e){throw null===(m=L.onLog)||void 0===m||m.call(L,"❌ Single frame test failed: ".concat(e)),Error("Optimized video appears corrupted - cannot extract frames: ".concat(e))}let T=[],B=0,S=0;for(;;){let e=25*B,n=e+500-1,a=0===B?["-i",D,"-frames:v","".concat(500),"-an","-threads","1","-c:v","rawvideo","-pix_fmt","rgb565be","-f","image2","-fps_mode","passthrough",o]:["-i",D,"-vf","select='between(n,".concat(e,",").concat(n,")'"),"-fps_mode","passthrough","-an","-threads","1","-c:v","rawvideo","-pix_fmt","rgb565be","-f","image2","-start_number","".concat(e+1),o];try{await t.exec(a)}catch(e){if(!String(e||"").includes("Aborted"))throw e}let r=[];try{console.log("[DEBUG] Attempting to list files after FFmpeg exec...");let e=await t.listDir("/");console.log("[DEBUG] Raw fileList:",e),r=e.filter(e=>{let t="string"==typeof e?e:e.name;return/^frame_\d{6}\.rgb$/.test(t)}),console.log("[DEBUG] Filtered frameFiles:",r),null===(h=L.onLog)||void 0===h||h.call(L,"Found ".concat(e.length," total files: ").concat(e.map(e=>"string"==typeof e?e:e.name).join(", "))),null===(v=L.onLog)||void 0===v||v.call(L,"Found ".concat(r.length," frame files: ").concat(r.map(e=>"string"==typeof e?e:e.name).join(", ")))}catch(e){console.log("[DEBUG] listDir failed, trying alternative approach:",e),r=[]}if(0===r.length){console.log("[DEBUG] No frames found via listDir, trying aggressive fallback...");for(let e=1;e<=500;e++){let n="frame_".concat(e.toString().padStart(6,"0"),".rgb");try{let e=await t.readFile(n);e&&e.length>0&&(r.push(n),console.log("[DEBUG] Fallback found frame: ".concat(n," (").concat(e.length," bytes)")))}catch(e){break}}if(0===r.length)try{for(let e of(await t.listDir("/"))){let n="string"==typeof e?e:e.name;if(n.endsWith(".rgb"))try{let e=await t.readFile(n);e&&e.length>0&&(r.push(n),console.log("[DEBUG] Emergency fallback found: ".concat(n," (").concat(e.length," bytes)")))}catch(e){console.log("[DEBUG] Failed to read ".concat(n,":"),e)}}}catch(e){console.log("[DEBUG] Emergency fallback failed:",e)}console.log("[DEBUG] Total fallback frames found: ".concat(r.length)),null===(w=L.onLog)||void 0===w||w.call(L,"Fallback method found ".concat(r.length," frame files"))}if(0===r.length){if(0===S){try{let e=await t.listDir("/");console.error("[DEBUG] All files in MEMFS:",e),null===(b=L.onLog)||void 0===b||b.call(L,"CRITICAL: No frames found despite ".concat(e.length," files in MEMFS. Files: ").concat(e.map(e=>"string"==typeof e?e:e.name).join(", ")))}catch(e){console.error("[DEBUG] Failed to list all files:",e)}throw null===(y=L.onLog)||void 0===y||y.call(L,"First chunk failed - no frames found. Check debug logs above."),Error("FFmpeg could not extract frames - check console for detailed debugging info")}break}for(let e of(r.sort((e,t)=>{let n="string"==typeof e?e:e.name,o="string"==typeof t?t:t.name;return parseInt(n.match(/\d+/)[0])-parseInt(o.match(/\d+/)[0])}),r)){let n="string"==typeof e?e:e.name;console.log("[DEBUG] Processing frame file: ".concat(n));let o=await t.readFile(n);T.push(o),S++;try{await t.deleteFile(n)}catch(e){console.log("[DEBUG] Could not delete ".concat(n,":"),e)}}let i=15+(B+=20)/600*80;null===(p=L.onProgress)||void 0===p||p.call(L,Math.min(i,95),"converting")}if(0===(x=S))throw Error("No frames were successfully extracted from video. Video may be corrupted or in an unsupported format.");null===(s=L.onProgress)||void 0===s||s.call(L,95,"converting"),null===(f=L.onLog)||void 0===f||f.call(L,"Packaging frames into single binary file...");let A=new Uint8Array(8+153600*x),G=new DataView(A.buffer);G.setUint32(0,x,!1),G.setUint32(4,153600,!1);let P=8;for(let e of T)A.set(e,P),P+=e.length;n.file("frames.bin",A);let j={slug:E,original_filename:e.name,type:"video",width:320,height:240,frame_count:x,format:"rgb565",fps:25};n.file("metadata.json",JSON.stringify(j));let z=await n.generateAsync({type:"blob"});if(null===(g=L.onProgress)||void 0===g||g.call(L,100,"converting"),"function"==typeof t.exit)try{await t.exit(),null===(F=L.onLog)||void 0===F||F.call(L,"FFmpeg WASM heap released")}catch(e){null===(_=L.onLog)||void 0===_||_.call(L,"Warning: FFmpeg cleanup failed: ".concat(e))}return{slug:E,blob:z}}}},9509:(e,t,n)=>{"use strict";var o,a;e.exports=(null==(o=n.g.process)?void 0:o.env)&&"object"==typeof(null==(a=n.g.process)?void 0:a.env)?n.g.process:n(666)}}]);